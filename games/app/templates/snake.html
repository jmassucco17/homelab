{% extends "base.html" %}

{% block title %}Snake{% endblock %}

{% block extra_head %}
  <style>
    .snake-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      padding: 1rem 0;
    }

    .snake-hud {
      display: flex;
      gap: 2rem;
      font-size: 1.1rem;
      font-weight: bold;
    }

    #snake-canvas {
      border: 2px solid var(--color-border, #444);
      border-radius: 4px;
      display: block;
      /* CSS size is set by JS to match devicePixelRatio */
    }

    .snake-overlay {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.6);
      color: #fff;
      border-radius: 4px;
    }

    .snake-overlay h2 {
      margin-bottom: 0.5rem;
    }

    .snake-overlay button {
      margin-top: 1rem;
      padding: 0.5rem 1.5rem;
      font-size: 1rem;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      background: #4caf50;
      color: #fff;
    }

    .snake-overlay button:hover {
      background: #43a047;
    }

    #canvas-wrapper {
      position: relative;
    }

    /* Touch controls */
    .touch-controls {
      display: grid;
      grid-template-columns: repeat(3, 3rem);
      grid-template-rows: repeat(3, 3rem);
      gap: 0.25rem;
      margin-top: 0.5rem;
    }

    .touch-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--color-card-bg, #222);
      border: 1px solid var(--color-border, #444);
      border-radius: 4px;
      font-size: 1.25rem;
      cursor: pointer;
      user-select: none;
      -webkit-user-select: none;
    }

    .touch-btn:active {
      background: var(--color-border, #444);
    }

    @media (pointer: fine) {
      /* Hide touch buttons on devices with a mouse */
      .touch-controls {
        display: none;
      }
    }
  </style>
{% endblock %}

{% block content %}
  <h1>üêç Snake</h1>

  <div class="snake-container">
    <div class="snake-hud">
      <span>Score: <span id="score">0</span></span>
      <span>Best: <span id="high-score">0</span></span>
    </div>

    <div id="canvas-wrapper">
      <canvas id="snake-canvas"></canvas>
      <div class="snake-overlay" id="start-overlay">
        <h2>Snake</h2>
        <p>Use arrow keys, WASD, or swipe to move.</p>
        <button id="start-btn">Start Game</button>
      </div>
    </div>

    <!-- On-screen directional buttons for mobile -->
    <div class="touch-controls" aria-label="Directional controls">
      <div></div>
      <button class="touch-btn" id="btn-up" aria-label="Up">‚ñ≤</button>
      <div></div>
      <button class="touch-btn" id="btn-left" aria-label="Left">‚óÄ</button>
      <div></div>
      <button class="touch-btn" id="btn-right" aria-label="Right">‚ñ∂</button>
      <div></div>
      <button class="touch-btn" id="btn-down" aria-label="Down">‚ñº</button>
      <div></div>
    </div>
  </div>
{% endblock %}

{% block extra_scripts %}
  <script src="/static/snake/snake.js"></script>
{% endblock %}
