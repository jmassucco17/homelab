{% extends "base.html.jinja2" %}

{% block title %}My Maps - Travel Maps{% endblock %}

{% block content %}
<div class="page-header">
    <h2>My Travel Maps</h2>
    <a href="/maps/new" class="btn btn-primary">+ New Map</a>
</div>

{% if maps %}
<div class="maps-grid">
    {% for map in maps %}
    <div class="map-card">
        <h3>{{ map.name }}</h3>
        {% if map.description %}
        <p class="description">{{ map.description }}</p>
        {% endif %}
        <div class="map-meta">
            <span class="location-count">{{ map.locations|length }} location{{ 's' if map.locations|length != 1 else '' }}</span>
            <span class="date">Updated: {{ map.updated_at.strftime('%b %d, %Y') }}</span>
        </div>
        <div class="card-actions">
            <a href="/maps/{{ map.id }}/view" class="btn btn-sm">View</a>
            <a href="/maps/{{ map.id }}/edit" class="btn btn-sm">Edit</a>
            <button onclick="deleteMap({{ map.id }})" class="btn btn-sm btn-danger">Delete</button>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <p>No maps yet. Create your first travel map!</p>
    <a href="/maps/new" class="btn btn-primary">+ Create Map</a>
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
async function deleteMap(mapId) {
    if (!confirm('Are you sure you want to delete this map?')) {
        return;
    }
    
    try {
        const response = await fetch(`/api/maps/${mapId}`, {
            method: 'DELETE'
        });
        
        if (response.ok) {
            window.location.reload();
        } else {
            alert('Failed to delete map');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('Failed to delete map');
    }
}
</script>
{% endblock %}
