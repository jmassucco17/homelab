# Staging overlay: routes assets.staging.jamesmassucco.com to a staging container.
# Merged with docker-compose.yml by scripts/start_service.sh --staging.
services:
  shared-assets:
    container_name: staging-shared-assets
    image: ghcr.io/jmassucco17/homelab/shared-assets:${STAGING_IMAGE_TAG:-latest}
    environment:
      - DOMAIN=staging.jamesmassucco.com
    labels:
      - 'traefik.http.routers.shared-assets-staging.rule=Host(`assets.staging.jamesmassucco.com`)'
      - 'traefik.http.routers.shared-assets-staging.entrypoints=websecure'
      - 'traefik.http.routers.shared-assets-staging.tls=true'
      - 'traefik.http.routers.shared-assets-staging.tls.certresolver=cloudflare'
      - 'traefik.http.routers.shared-assets-staging.middlewares=ratelimit'
      - 'traefik.http.services.shared-assets-staging.loadbalancer.server.port=80'
