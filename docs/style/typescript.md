# TypeScript Style / Usage

TypeScript is used for the `games/` frontend (browser-side code in `games/app/static/`).

## Linting and type-checking

- Type-check with `npm run lint:ts` (runs `tsc --noEmit`)
- Build (emit JS) with `npm run build:ts` (used by Docker; not needed for local dev if `*.js` files are present)
- TypeScript checking is also run in CI via the `lint-ts` job in `_linting.yml`
- A pre-commit hook runs `tsc --noEmit` automatically on `.ts` file changes

## Configuration

The `tsconfig.json` lives at `games/app/static/tsconfig.json` with `"strict": true`.  All frontend TypeScript must pass strict type checking.

## File structure

- Source files: `games/app/static/**/*.ts`
- Compiled output: `games/app/static/**/*.js` (gitignored; generated by Docker build or `npm run build:ts`)
- TypeScript compiles in-place alongside source files

## Module system

All files must be ES modules.  Files that don't export anything must include `export {}` at the end.  Use `.js` extensions in imports (e.g. `import { Foo } from './foo.js'`) â€” this is required for browser ES modules and TypeScript compiles them correctly.

All `<script>` tags that load compiled TypeScript output must use `type="module"`.

## Type annotations

- Annotate all function parameters and return types explicitly
- Use `interface` for object shapes; prefer `interface` over `type` for plain object shapes
- Use `type` for union types, mapped types, and other non-object shapes
- Prefer `unknown` over `any`; narrow with type guards before use
- Use `as` casts only when the type is genuinely known (e.g. DOM element lookups)
- Use `!` non-null assertions only when null/undefined is provably impossible in context

## Class properties

Declare all class instance properties with their types at the top of the class body (before the constructor).  Example:

```typescript
export class Foo {
  bar: string
  baz: number | null

  constructor(bar: string) {
    this.bar = bar
    this.baz = null
  }
}
```

## DOM interactions

Use `as HTMLCanvasElement` / `as HTMLInputElement` etc. for `document.getElementById` calls when the element type is known from the HTML template.  Use `!` for non-optional lookups that are guaranteed by the template.

## Strictness checklist

- `strict: true` covers: `strictNullChecks`, `strictFunctionTypes`, `noImplicitAny`, etc.
- Avoid suppressing errors with `// @ts-ignore` or `// @ts-expect-error` unless absolutely necessary
